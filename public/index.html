<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JukeBox CafÃ©</title>
<style>
  body {
    font-family: system-ui, sans-serif;
    background: #fdf8f3;
    text-align: center;
    padding: 2em;
  }
  h1 { color: #d66b00; }
  input {
    width: 90%;
    max-width: 400px;
    padding: 0.8em;
    margin: 1em 0;
    border: 2px solid #d66b00;
    border-radius: 10px;
    font-size: 1em;
  }
  button {
    background: #d66b00;
    color: #fff;
    border: none;
    padding: 0.8em 2em;
    border-radius: 10px;
    font-size: 1em;
    cursor: pointer;
  }
  button:hover { background: #ff7f00; }
</style>
</head>
<body>
  <h1>ğŸµ JukeBox CafÃ©</h1>
  <p>Recherche ta musique sur YouTube Music :</p>

  <input id="search" type="text" placeholder="ex : Daft Punk â€“ Get Lucky">
  <br>
  <button onclick="searchYTMusic()">Rechercher</button>
  <br>
  <button onclick="pasteLink()">ğŸ“‹ Coller depuis le presse-papiers</button>
  <br>
  <button onclick="addMusic()">ğŸ¶ Ajouter cette musique</button>

  <script>
    function searchYTMusic() {
      const query = encodeURIComponent(document.getElementById('search').value.trim());
      if (!query) return;
      window.open(`https://music.youtube.com/search?q=${query}`, '_blank');
    }

    async function pasteLink() {
      const text = await navigator.clipboard.readText();
      document.getElementById('search').value = text;
    }

    function addMusic() {
      const link = document.getElementById('search').value.trim();
      const params = new URLSearchParams(window.location.search);
      const cafe = params.get('cafÃ©') || 'default';

      if (!link.startsWith('http')) {
        alert("Entre un lien YouTube valide !");
        return;
      }

      fetch(`/add?cafÃ©=${encodeURIComponent(cafe)}&link=${encodeURIComponent(link)}`)
        .then(res => res.ok
          ? alert("âœ… Ta musique a Ã©tÃ© ajoutÃ©e !")
          : alert("âŒ Erreur dâ€™ajout"))
        .catch(() => alert("âš ï¸ Erreur rÃ©seau"));
    }
  </script>
</body>
</html>
